# 분산락
> 같은 쓰레드에서만 유효한 Lock인지 확인하자

동시성 이슈때문에 데이터가 틀어질 수 있어서 분산 락을 적용해 데이터의 정합성을 맞춰야 할 때가 있다.

그 때 redis를 이요한 분산락을 사용하는 경우가 있는데, 이 때 해당 lock을 확인하는 범위가 같은 쓰레드 내에서만 유효한지 확인이 필요하다.

lock 점유 여부를 redis의 키로 확인을 하게 되는데, 이 키에 사용자가 지정하지 않았지만 thread 아이디가 들어갈 수 있다. 이 경우 쓰레드 아이디가 달라지면 키가 달라져 같은 lock을 점유했다고 판단하지 않기 떄문에 lock이 제대로 동작하지 않을 수 있다.